"use strict";class Wyre{constructor(a){this.data=a,null==a.env&&(a.env="production");let b=window.addEventListener?"addEventListener":"attachEvent",c="attachEvent"==b?"onmessage":"message";window[b](c,a=>{if("string"==typeof a.data){let b=JSON.parse(a.data);switch(b.action){case"close":this.iframe&&document.body.removeChild(this.iframe),this.iframe=null,this.data.onExit();break;case"complete":this.iframe&&document.body.removeChild(this.iframe),this.iframe=null,this.data.onSuccess();break;case"sign":let c=new Web3(web3.currentProvider);c.personal.sign(c.fromUtf8(b.message),b.address,(a,b)=>{this.iframe.contentWindow.postMessage(JSON.stringify({action:"sign",signature:b,error:a}),"*")});break;default:console.log(a);}}},!1),this.createIframe()}open(){this.iframe||this.createIframe(),this.iframe.style.display="block"}createIframe(){this.iframe=document.createElement("iframe"),this.iframe.style.display="none",this.iframe.style.border="none",this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.position="fixed",this.iframe.style.zIndex="999999",this.iframe.style.top="0",this.iframe.style.left="0",this.iframe.style.bottom="0",this.iframe.style.right="0",this.iframe.style.backgroundColor="transparent";let a=[];a.push("apiKey="+this.data.apiKey),this.data.destCurrency&&a.push("destCurrency="+this.data.destCurrency),this.iframe.src=this.getBaseUrl()+"/open?"+a.join("&"),document.body.appendChild(this.iframe)}getBaseUrl(){switch(this.data.env){case"test":return"https://verify.testwyre.com";case"staging":return"https://verify-staging.i.sendwyre.com";case"local":return"http://localhost:8890";case"local_https":return"https://localhost:8890";case"production":default:return"https://verify.sendwyre.com";}}}export default Wyre;